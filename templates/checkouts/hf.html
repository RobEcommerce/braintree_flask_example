{% extends 'layout.html' %}
{% block content %}

<div class="wrapper">
  <div class="checkout container">

    <header>
      <h1>Hi, <br>Let's test Hosted Fields</h1>
      <p>
        Make a test payment with Braintree using PayPal or a card
      </p>
    </header>

    <form id="payment-form" method="post" action="/checkouts">
        <label for="card-number">Card Number</label>
        <div id="card-number"></div>
  
        <label for="cvv">CVV</label>
        <div id="cvv"></div>
  
        <label for="expiration-date">Expiration Date</label>
        <div id="expiration-date"></div>
  
        <input type="submit" value="Pay" disabled />
      </form>
  
      <script src="https://js.braintreegateway.com/web/3.83.0/js/client.min.js"></script>
      <script src="https://js.braintreegateway.com/web/3.83.0/js/hosted-fields.min.js"></script>
      <script>
        var form = document.querySelector('#payment-form');
        var submit = document.querySelector('input[type="submit"]');
  
        braintree.client.create({
          authorization: client_token
        }, function (clientErr, clientInstance) {
          if (clientErr) {
            console.error(clientErr);
            return;
          }
  
          // This example shows Hosted Fields, but you can also use this
          // client instance to create additional components here, such as
          // PayPal or Data Collector.
  
          braintree.hostedFields.create({
            client: clientInstance,
            styles: {
              'input': {
                'font-size': '14px'
              },
              'input.invalid': {
                'color': 'red'
              },
              'input.valid': {
                'color': 'green'
              }
            },
            fields: {
              number: {
                container: '#card-number',
                placeholder: '4111 1111 1111 1111'
              },
              cvv: {
                container: '#cvv',
                placeholder: '123'
              },
              expirationDate: {
                container: '#expiration-date',
                placeholder: '10/2022'
              }
            }
          }, function (hostedFieldsErr, hostedFieldsInstance) {
            if (hostedFieldsErr) {
              console.error(hostedFieldsErr);
              return;
            }
  
            submit.removeAttribute('disabled');
  
            form.addEventListener('submit', function (event) {
              event.preventDefault();
  
              hostedFieldsInstance.tokenize(function (tokenizeErr, payload) {
                if (tokenizeErr) {
                  console.error(tokenizeErr);
                  return;
                }
  
                // If this was a real integration, this is where you would
                // send the nonce to your server.
                console.log('Got a nonce: ' + payload.nonce);
              });
            }, false);
          });
        });
      </script>

{% endblock %}
